---
layout: post
title: ReactGuide-01
date: 2023-11-03 16:45:30.000000000 +09:00
categories: [Web, React, 入门]
tags: [Web, React]
---


# 简介

* React 用于构建用户界面的 js 库。它操作 `DOM` 呈现页面
* React 是一个将数据渲染为 HTML 视图的开源 javaScript 库

## 为什么学 react？
1. 原生 js 操作 `DOM` 繁琐、效率低（DOM-API 操作 UI）
2. 原生 js 直接操作 DOM，浏览器会进行大量的重绘重排
3. 原生 js 没有组件化编码方案，代码复用率低

## react 特点
1. 采用组件化模式、声明式编码、提高开发效率及组件复用率
2. 在 React Native 中可以使用 React 语法进行移动端开发
3. 使用`虚拟 DOM 技术`(React 创建的)和优秀的`Diffing 算法`（简单理解为增量更新渲染），尽量减少与真实 `DOM` 的交互
  * 不总是直接操作页面真实 `DOM`，更新前会进行比较，比较出有差异的部分再更新那部分

## 官方网站

- [英文官网](https://react.dev/)

- [中文官网](https://react.docschina.org/)

> 建议尽量看英文的
{: .prompt-info }



# React 库介绍
* [babel.min.js 库](https://unpkg.com/babel-standalone@6.26.0/babel.min.js)，作用：
1. ES6 转换为 ES5
2. jsx 转换位 js（react 写的是 jsx）

* [react.development.js 库](https://unpkg.com/react@18.0.0/umd/react.development.js)：React 核心库
* [react-dom.development.js](https://unpkg.com/react-dom@18.0.0/umd/react-dom.development.js)：React 扩展库，用于操作 `DOM`


## Hello World 案例

* 下边示例，为了理解底层原理

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>hello react</title>
  </head>
  <body>
    <div id="test"></div>

    <!-- 引入 react 核心库 -->
    <script type="text/javascript" src="../js/react.development.js"></script>

    <!-- 引入 react-dom 库，用于支持 react 操作 DOM -->
    <script
      type="text/javascript"
      src="../js/react-dom.development.js"
    ></script>

    <!-- 引入 babel，用于将 jsx 转为 js -->
    <script type="text/javascript" src="../js/babel.min.js"></script>

    <!-- 这里必须写 babel -->
    <script type="text/babel">
      // 1 创建虚拟 DOM
      const VDOM = <h1>Hello,React</h1>; // 这里不能写引号, 因为不是字符串
      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
  </body>
</html>
```

# 关于虚拟 DOM
1. 本质是 `Object` 类型的对象（一般对象）
2. `虚拟 DOM` 比较 `轻`(属性少)，`真实 DOM` 比较 `重`。因为`虚拟 DOM` 是 `React 内部`在用，无需`真实 DOM` 上那么多的属性
3. `虚拟 DOM` 最终会被 React 转化为`真实 DOM，呈现在页面上


# jsx（JavaScript XML） 语法
* react 定义的一种类似于 XML 的 JS 扩展语法：`JS+XML`

## jsx 语法规则：
* 1 定义 `虚拟 DOM` 时，不要写引号

* 2 标签中混入 `JS 表达式`时，需要用 `{}`

```html
    <script type="text/babel">
      const myId = "utdd";
      const myData = "HeLo,rEact";
      // 1 创建虚拟 DOM
      const VDOM = (
        <h2 id={myid.toLowerCase()}>
          <span>{myData.toLowerCase()}</span>
        </h2>
      ); // 这里不能写引号，因为不是字符串

      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
```

* 3 样式的类名指定不要用 `class`，要用 `className`

```html
<style>
  .title {
    background-color: orange;
    width: 200px;
}
</style>


    <script type="text/babel">
      const myId = "custom";
      const myData = "HeLo,rEact";
      // 1 创建虚拟 DOM
      const VDOM = (
        <h2 className="title" id={myid.toLowerCase()}>
          <span>{myData.toLowerCase()}</span>
        </h2>
      ); // 这里不能写引号，因为不是字符串

      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
```

* 4 内联样式，要用 `style={ {key:value } }` 的形式去写

```html
    <script type="text/babel">
      const myId = "custom";
      const myData = "HeLo,rEact";
      // 1 创建虚拟 DOM
      const VDOM = (
        // style={ {} }，外层 {}，表示要里边写的是 js 表达式；内层的 {}，表示写的是一个对象
        <h2 id={myid.toLowerCase()}>
          <span style={ { color: 'white', fontSize: '20px' } }>
            {myData.toLowerCase()}
          </span>
        </h2>
      ); // 这里不能写引号，因为不是字符串

      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
```

* 5 `虚拟 DOM` 只能有一个根标签。比如下边可以用 `div` 包裹多个 `h2`

```html
    <script type="text/babel">
      const myId = "custom";
      const myData = "HeLo,rEact";
      // 1 创建虚拟 DOM
      const VDOM = (
        <div>
          <h2 id={myid.toLowerCase()}>
            <span style={ { color: 'white', fontSize: '20px' } }>
              {myData.toLowerCase()}
            </span>
          </h2>
          <h2 id={myid.toUpperCase()}>
            <span style={ { color: 'white', fontSize: '20px' } }>
              {myData.toLowerCase()}
            </span>
          </h2>
        </div>
      );
      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
```

* 6 标签必须闭合。下边的 `input` 标签必须闭合

```html
    <script type="text/babel">
      const myId = "custom";
      const myData = "HeLo,rEact";
      const VDOM = (
        // style={{}}，外层 {}，表示要里边写的是 js 表达式；内层的 {}，表示写的是一个对象
        <div>
          <h2 id={myid.toLowerCase()}>
            <span style={ { color: "white", fontSize: "20px" } }>
              {myData.toLowerCase()}
            </span>
          </h2>
          <input type="text" />  // Note：这里必须是闭合的
        </div>
      );
    </script>
```

* 7 标签首字母
  1. 若小写字母开头，则将标签转为 `html` 中同名元素。若 `html` 中无该标签对应的同名元素，则报错
  2. 若大写字母开头，`react` 就去渲染对应的组件，若组件没有定义，则报错


# jsx 小练习


```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>hello react</title>
  </head>
  <body>
    <!-- 准备好一个容器 -->
    <div id="test"></div>

    <!-- 引入 react 核心库 -->
    <script type="text/javascript" src="../js/react.development.js"></script>

    <!-- 引入 react-dom 库，用于支持 react 操作 DOM -->
    <script
      type="text/javascript"
      src="../js/react-dom.development.js"
    ></script>

    <!-- 引入 babel，用于将 jsx 转为 js -->
    <script type="text/javascript" src="../js/babel.min.js"></script>

    <script type="text/babel">
      const data = ["Angular", "React", "Vue"];

      // 1 创建虚拟 DOM
      const VDOM = (
        <div>
          <h1>前端 js 框架列表</h1>
          <ul>
            // 必须指定 key
            {data.map((item, index) => {
              return <li key={index}>{item}</li>;
            })}
          </ul>
        </div>
      );

      // 2 渲染虚拟 DOM 到页面
      ReactDOM.render(VDOM, document.getElementById("test"));
    </script>
  </body>
</html>
```


## js 表达式 VS js 语句


* 表达式会产生一个值
* 下面都是表达式
  1. a
  2. b
  3. demo(1)（函数表达式，若函数没返回，默认返回 undefined）
  4. arr.map()
  5. function tetst () {}


# 安装 Chrome 扩展工具

* Chrome-更多工具-扩展程序中，搜索 `React Developer Tools` (Facebook 出品)
* 然后将此扩展程序 Pin 到浏览器快捷栏中
* 如果打开一个 react 写的网页
  * 这个插件为红色：说明你的网页没有通过打包上线，而是通过 `127.0.0.1` 这种形式访问的

* 安装扩展后，开发者工具会多出现两个组件，如下图：
  * Components 用于查看有多少个组件，以及组件细节
  * Profiler 用于记录网页的性能

![image](/assets/images/react/guide/tools.png)


# React 面向组件编程

## 定义组件两种方式：
1. 函数式组件：用函数定义出的组件（适用于简单组件的定义）
2. 类式组件：用类定义出的组件（适用于复杂组件的定义）


## 函数式组件的使用

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>hello react</title>
  </head>
  <body>
    <!-- 准备好一个容器 -->
    <div id="test"></div>

    <!-- 引入 react 核心库 -->
    <script type="text/javascript" src="../js/react.development.js"></script>

    <!-- 引入 react-dom 库，用于支持 react 操作 DOM -->
    <script
      type="text/javascript"
      src="../js/react-dom.development.js"
    ></script>

    <!-- 引入 babel，用于将 jsx 转为 js -->
    <script type="text/javascript" src="../js/babel.min.js"></script>

    <script type="text/babel">
      // 定义函数, 函数名就是组件名
      function MyComponent() {
        // 此处的 this 是 undefined，
        // 因为 babel 翻译后，开启了严格模式，禁止了函数中的 this 指向 window
        // 可在 babel 官网试一试查看
        console.log(this);
        return <h2>我是用函数定义的组件（适用于简单组件）</h2>;
      }

      ReactDOM.render(<MyComponent />, document.getElementById("test"));
      /*
            执行了 ReactDOM.render(<MyComponent />... 后，发生了什么？
                1. React 解析组件标签，找到 MyComponent 组件
                2. 发现组件是使用函数定义的，然后调用该函数，
                将返回的虚拟 DOM 转为真实 DOM，并呈现在页面中
            Note: 1. 组件首字母必须大小
                  2. 函数有返回值
                  3. render 参数必须传组件名称
      */
    </script>
  </body>
</html>
```


## 类式组件

### 类复习

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1_类的基本知识</title>
  </head>
  <body>
    <script type="text/javascript">
      /*
        总结：
            1. 类中的构造器不是必须写的，需要对实例进行一些初始化操作时才需要写
            2. 如果 A 类继承了 B 类，并且 A 中写了构造器，那么 A 中构造器的 super 必须调用
            3. 类中定义的方法，都是放在类的原型对象上，供实例去使用
      */

      // 创建一个 Person 类
      class Person {
        // 构造器方法
        constructor(name, age) {
          // 构造器中的 this 是谁？---是类的实例对象
          this.name = name;
          this.age = age;
        }

        // 一般方法
        speak() {
          // speak 方法放在了哪里？----类的原型对象上，供实例使用
          // 通过 Person 实例调用 speak 时，speak 中的 this 就是 Person 实例
          console.log(`我叫 ${this.name}, 我年龄是 ${this.age}`);
        }
      }

      // 创建 Person 实例对象
      const p1 = new Person("tom", 18);
      console.log(p1);
      const p2 = new Person("Jack", 19);
      console.log(p1);

      p1.speak();
      p2.speak();
      /*
        speak 中的 this 是谁，要看函数是怎么调用的？
        call 方法可以改变 this 指向
      */
      p1.speak.call({ a: 1, b: 2 }); // 我叫 undefined, 我年龄是 undefined

      // 创建 Student 类，继承于 Person 类
      class Student extends Person {
        constructor(name, age, grade) {
          super(name, age); // 最开始调用 super
          this.grade = grade;
          this.school = "北大";
        }
        // 一般方法, override
        speak() {
          console.log(
            `我叫 ${this.name}, 我年龄是 ${this.age}, 我读的是${this.grade}年级`
          );
        }
        study() {
          // study 方法放在了哪里？----类的原型对象上，供实例使用
          // 通过 Student 实例调用 study study 中的 this 就是 Student 实例
          console.log("努力学习");
        }
      }

      const s1 = new Student("小张", 15, "高三");
      console.log(s1);
      s1.speak();
    </script>
  </body>
</html>
```

### 类式组件的使用

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>hello react</title>
  </head>
  <body>
    <!-- 准备好一个容器 -->
    <div id="test"></div>

    <!-- 引入 react 核心库 -->
    <script type="text/javascript" src="../js/react.development.js"></script>

    <!-- 引入 react-dom 库，用于支持 react 操作 DOM -->
    <script
      type="text/javascript"
      src="../js/react-dom.development.js"
    ></script>

    <!-- 引入 babel，用于将 jsx 转为 js -->
    <script type="text/javascript" src="../js/babel.min.js"></script>

    <script type="text/babel">
      // 定义类式组件
      // 1 必须继承于 React.Component
      // 2 必须写 render()
      class MyComponent extends React.Component {
        render() {
          // render 谁放在哪里的？---MyComponent 的原型对象上，供实例使用
          // render 中的 this 是谁？---MyComponent 的实例对象，或叫组件实例对象
          console.log("render 中的 this：", this);
          return <h2>我是用类定义的组件（适用于复杂组件）</h2>;
        }
      }

      ReactDOM.render(<MyComponent />, document.getElementById("test"));
      /*
            执行了 ReactDOM.render(<MyComponent />... 后，发生了什么？
                1. React 解析组件标签，找到 MyComponent 组件
                2. 发现组件是使用类定义的，然后 new 出该类的实例，并通过该实例调用原型上的 render 方法
                3. 将 render 返回的虚拟 DOM 转为真实 DOM，并呈现在页面中
                 
            组件的三大属性：
                1. props
                2. refs
                3. state
            组件的另外关注的属性：context
      */
    </script>
  </body>
</html>
```
