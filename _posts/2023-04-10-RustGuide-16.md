---
layout: post
title: RustGuide-16
date: 2023-04-10 16:45:30.000000000 +09:00
categories: [Rust]
tags: [Rust]
---

# 19 高级特性

## Unsafe Rust（不安全 Rust）

### 匹配命名变量
* 在 Rust 中隐藏着第二个语音，它没有强制内存安全保证，它就是 Unsafe Rust
* Unsafe Rust 与普通的 Rust 一样，但提供了一些 “超能力”
* Unsafe Rust 存在是因为以下几个原因
1. 静态分析是保守的（即出于安全考虑会错误判断一些情况为不合法），而使用 Unsafe Rust，即告诉编译器我们知道自己在做什么，并承担相应风险
2. 计算机硬件本身就是不安全的，Rust 需要能够进行底层的系统编程，如果不允许 Unsafe Rust 那么这些工作就无法完成了

### Unsafe 超能力
* 可以使用 unsafe 关键字来切换到 Unsafe Rust 模式，它会后边跟着一个代码块，在这个代码块里写的代码就是 unsafe 代码
* Unsafe Rust 里可执行 4 个动作（超能力）
1. 解引用原始指针
2. 调用 unsafe 函数或方法
3. 访问或修改可变的静态变量
4. 实现 unsafe trait

> unsafe 并没有关闭借用检查或停用其他的安全检查措施，如果你在 unsafe 里使用引用，那么这个引用依然会被检查，unsafe 仅仅是让你可以访问上述 4 个特性，所以即便是 unsafe 中你依然会获得一定的安全性，通过把上边 4 种不安全操作约束在 unsafe 代码块中，你就要知道任何内存安全相关的错误必须留在 unsafe 块里，尽可能隔离 unsafe 代码，最后将其封装在安全的抽象里，提供安全的 API。实际上某些标准库就使用了 unsafe 代码，但他们在这之上又提供了安全的抽象接口，因为使用安全的抽象是安全的。
{: .prompt-info }


### 1 解引用原始指针




## 高级 Trait

## 高级类型

## 高级函数和闭包

## 宏


