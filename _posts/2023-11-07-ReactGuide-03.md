---
layout: post
title: ReactGuide-03
date: 2023-11-07 16:45:30.000000000 +09:00
categories: [Web, React, 入门]
tags: [Web, React]
---


# React 脚手架

## 简介
* 脚手架时用来帮助开发者快速创建一个基于某个库的模板项目，这里的脚手架是用 `webpack` 搭建的
* react 提供了一个用于创建 react 项目的脚手架库：`create-react-app`
* 项目的整体技术框架为：`react + webpack + es6 + eslint`

## 安装

```shell
$ npm i -g create-react-app

# create-react-app [项目名称]
$ create-react-app hello-react
```

## 基本命令

```shell
# 启动项目，查看开发效果
# 通过 webpack-dev-server 开启 http://localhost:3000 进行访问
$ yarn start

# 将项目打包，生成静态文件，准备部署
$ yarn build

# React 会把 webpack 文件全部隐藏
# 此命令会把所有 webpack 都暴露出来，此命名不可逆
$ yarn eject
```

> `package.json` 为包配置文件
{: .prompt-info }

## 项目结构介绍

* 如图

![image](/assets/images/react/guide/app_dir.png)

### `public` 目录（不能改名）：一般存储静态资源文件，例如页面、样式、图片等
* 1 `favicon.ico`
* 2 `index.html`：主页面（开发中只有这一个页面）
  * React/Vue 开发是单页面应用（SPA）
    
```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <!-- 指定网页页签的图标，用 link 方式引入 -->
    <!-- %PUBLIC_URL% 表示 public 目录的路径 -->
    <!-- <link rel="icon" href="%PUBLIC_URL%/favicon.ico" /> -->
    <!-- 也可以用相对路径写 -->
    <link rel="icon" href="./favicon.ico" />

    <!-- 用于移动端网页适配 -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- 用于配置浏览器页签+地址栏的颜色（只支持于 Android 手机平台，很少用） -->
    <meta name="theme-color" content="#000000" />

    <!-- 描述网页信息 -->
    <meta
      name="description"
      content="Web site created using create-react-app"
    />

    <!-- Apple 手机添加网页到主屏后的图标  -->
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />

    <!-- manifest.json 用于应用加壳的配置文件，兼容性不好，不加壳可以忽略  -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

    <title>React App</title>
  </head>
  <body>
    <!-- 若浏览器不支持 js 则展示标签中的内容 -->
    <noscript>You need to enable JavaScript to run this app.</noscript>
    
    <!-- App 组件放到 root 节点中 -->
    <div id="root"></div>
  </body>
</html>
```

* 3 `robots.txt`：爬虫规则文件，什么可爬，什么不可爬


### `src` 目录（不能改名）：
* `App.js`：即 `App` 组件
* `App.css`：组件 `App` 的样式
* `App.test.js`：用于测试 `App` 的，但很少用，一般之间运行进行测试
* `index.css`：通用的样式
* `index.js`：入口文件，在这个文件引入 `react`、`react-dom`
  * `<React.StrictMode>` 可以检查 `<App />` 中的代码是否合理
  * `reportWebVitals` 用于记录页面性能，使用了 `web-vitals` 库

```javascript
import React from "react";
import ReactDOM from "react-dom/client";
import "./index.css";
import App from "./App";
import reportWebVitals from "./reportWebVitals";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

// If you want to start measuring performance in your app, pass a function
// to log results (for example: reportWebVitals(console.log))
// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals
reportWebVitals();
```

* `setupTests.js`：用于应用整体测试，组件测试，使用了 `jest-dom` 库

### 启动流程
1. `index.js` 开始 `render` 组件 `App`
2. 去 `index.html` 中找 `root` 容器
  * `index.html` 名字不能改，是 React 底层写死的


> 重要的文件 `index.html`(主页面)、`App.js`（组件）、`index.js`（入口文件）
{: .prompt-info }


## Hello Demo

### `js` 的两种目录结构编程风格：
1. `src/component/Hello/Hello.js`：
  * 优点：查看直观，方便查找
  * 缺点：引入时，啰嗦，`import Hello from "./components/Hello/Hello"`
  
2. `src/component/Welcome/index.js`：
  * 优点：引入时简便，`import Welcome from "./components/Welcome"` 即找 `Welcome` 目录下的 `index.js` 引入
  * 缺点：查看代码是可能不能直观的告你开发者是哪个 `index`

```javascript
/*
  两种目录结构
  src/component/Hello/Hello.js
  src/component/Welcome/index.js
*/
import Hello from "./components/Hello/Hello";
import Welcome from "./components/Welcome";
```

### css 模块化

```javascript
import React, { Component } from "react";
/*
  css 模块化
  1 将 css 文件定义为 index.module.css
  2 import welcome from "./index.module.css";
  3 标签中 className={welcome.demo}
*/
import welcome from "./index.module.css";

export default class Welcome extends Component {
  render() {
    return <h2 className={welcome.demo}>Welcome!</h2>;
  }
}
```

### 插件安装
* 在 VSCode 中搜 `ES7+ React/Redux/React-Native snip`，安装它
  * 在 `js` 或 `jsx` 文件中：
    * 输入 `rcc`，即可定义类组件模板
    * 输入 `rfc`，即可定义函数组件模板


### Hello 结构

![image](/assets/images/react/guide/hello.png)


* index.js

```javascript
// 引入 React 核心库
import React from "react";
// 引入 ReactDOM 核心库
import ReactDOM from "react-dom";
import "./index.css";
// 引入 App 组件
import App from "./App";
import reportWebVitals from "./reportWebVitals";

// 渲染 App 组件到页面
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);

reportWebVitals();
```


* App.js

```javascript
/*
    import React, { Component } 这么引入说明 react 中有默认暴露，和部分暴露
    { Component } 将部分暴露的 Component 引入
    React 为默认暴露
 */
import React, { Component } from "react";
import Hello from "./components/Hello/Hello";
import Welcome from "./components/Welcome";

// 暴露并定义 App 组件
export default class App extends Component {
  render() {
    return (
      <div>
        <Hello />
        <Welcome />
      </div>
    );
  }
}
```

* src/components/Welcome.index.js

```javascript

import React, { Component } from "react";
/*
  css 模块化
  1 将 css 文件定义为 index.module.css
  2 import welcome from "./index.module.css";
  3 标签中 className={welcome.demo}
*/
import welcome from "./index.module.css";

export default class Welcome extends Component {
  render() {
    return <h2 className={welcome.demo}>Welcome!</h2>;
  }
}
```

* src/components/index.module.css

```css
.demo {
  background-color: pink;
}
```

> Note：文件名大写开头的 `js` 文件为组件，可将其改为 `jsx` 结尾。React 中引入时 `js`、`jsx` 可以省略结尾。
{: .prompt-info }
